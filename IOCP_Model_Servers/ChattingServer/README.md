# Chatting Server(Version 1)

- OverlappedIO(IOCP) 모델로 만들어진 채팅 서버 
- MMO게임 서버의 채팅서버를 가정한 서버
- Spec
  1. Windows환경에서 개발(IOCP 사용및 Interlocked 사용으로 os 종속적)
  2. c++ 구현
  3. VS 2019
- 기능
  1. 로그인
  2. 섹터 이동
  3. 채팅 요청
- 부재
  1. DB연동 없음
- 한계
  1. 싱글 스레드이기 때문에 모든 워커쓰레드들의 싱글 쓰레드로의 JobEnqueue 과정에서의 병목 발생.
  2. 사실상 워커쓰레드들이 IO완료 처리 이외에 아무 작업을 하지 않기 때문에 cpu 사용율이 아주 낮음(Worker지만 거의 일을 하지 않고 있음)
  3. 

# Chatting Server(Version 2)

- OverlappedIO(IOCP) 모델로 만들어진 채팅 서버
- MMO게임 서버의 채팅서버를 가정한 서버
- Spec
  1. Windows 환경에서 개발
  2. 클라이언트는 윈도우 종속적(Windows API사용 및 Async Select 사용)
  3. c++ 구현
- 기능
  1. 로그인
  2. 섹터이동
  3. 채팅요청
- 구현시 주의사항
  1. 동기화 객체를 사용할 때 락의 순서를 맞추지 않으면 데드락에 빠지게됨
  1. 섹터 이동시 두개의 섹터 락이 동시에 확보되지 않으면 작업을 진행하지 않음(TryLock을 사용, 하나 성공후 실패시 Unlock + YieldProcessor를 통해 다른 쓰레드가 해제할 수 있도록 유도함)
- Version1 에서의 개선점
  1. 컨텐츠 부분의 각 섹터에 락을 걸고 워커 쓰레드가 작업 처리.
  2. 섹터는 50*50 크기로 확률상 3% 이내의 확률로 경합 발생.
  3. 경합 발생율이 적기 때문에 거의 대부분의 경우 여러 쓰레드가 동시에 일을 할 수 있으므로 성능이 빠름.
